from numpy import linspace
from scipy.stats import gaussian_kde, entropy
import numpy as np

a = [8.445539, 8.183218, 7.7131796, 7.4841185, 6.2152004, 6.033386, 5.8567805,
     5.704071, 5.5711575, 5.240162, 5.059968, 4.993699, 4.913089, 4.6086397, 4.474599,
     4.4812465, 4.380814, 4.146108, 4.052527, 4.1341224, 3.8573222]

b = [8, 8.183218, 7.7131796, 7.4841185, 6.2152004, 6.033386, 5.8567805,
     5.704071, 5.5711575, 5.240162, 5.059968, 4.993699, 4.913089, 4.6086397, 4.474599,
     4.4812465, 4.380814, 4.146108, 4.052527, 4.1341224, 3.8573222]

bm = [8.440438, 8.268477, 8.10135, 7.895132, 7.570122, 7.463193, 7.054717,
     6.901272, 6.604419, 6.5386224, 6.1980534, 6.2692723, 6.2294426, 5.928009,
     5.8564525, 5.7709417, 5.678486, 5.351684, 5.2552185, 5.258977, 4.8334904]

#ks判断是否满足同一种分布
from scipy.stats import ks_2samp
print(ks_2samp(a,b))
#Ks_2sampResult(statistic=0.5238095238095237, pvalue=0.003591277064281285)

#计算散度
n1 = len(a)
n2 = len(b)
a1 = min(min(a), min(b))
b1 = max(max(a), max(b))
lin = linspace(a1, b1, max(n1, n2))
#使用高斯kde估计pdf，pdf:概率密度
pdf1 = gaussian_kde(a)
pdf2 = gaussian_kde(b)
p = pdf1.pdf(lin)
q = pdf2.pdf(lin)
print(entropy(a, bm))



